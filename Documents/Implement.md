# 実装手順について

## 概要

- このドキュメントは、AI による自動コーディングにおいて、どのような手順で実装をするかを説明するものです

## 実装するアプリケーションについての説明

- C# 及び、C++ でそれぞれ、レトロコンピュータのエミュレータ等で使用されるディスクイメージを取り扱うためのライブラリを実装してください
- 具体的なフォルダ構造については、Documents フォルダ内の Folder.md を参照してください
- 将来的には様々なディスクフォーマットについて対応しますが、今回は D88 フォーマットのみを対応するようにしてください
- D88 フォーマットについては、Documents フォルダ内の D88_Format.md を参照してください
- ディスクイメージフォーマットである D88 はあくまでもフロッピーなどのメディアのイメージを取り扱うコンテナであり、基本的にはディスクイメージ、シリンダー、セクターなどへのアクセスを提供します、また、ひとつのディスクイメージファイルの中には複数のメディア（フロッピーなど）が含まれる可能性があります
- ディスクイメージフォーマットである D88 の中には各種 OS など、ファイルシステムによって様々なファイルアクセスを行うためのファイルシステムが必要となります
- 将来的には様々なファイルシステムについて対応しますが、今回は Hu-BASIC ファイルシステムのみを対応するようにしてください
- Hu-BASIC ファイルシステムについては、Documents フォルダ内の Hu-BASIC_Format.md を参照してください
- ファイルシステムである Hu-BASIC ファイルシステムは、ディレクトリ、ファイル、クラスタ、FAT、ブートセクタなど、様々な概念を用いて構成されています
- 今回実装するライブラリは、C# 及び C++ でディスクイメージフォーマットとファイルシステムの組み合わせを選択し、ディスクイメージ内のファイルシステムにアクセスするための機能を提供するものです
- つまり、例えば、D88 フォーマットのディスクイメージファイルを読み込み、Hu-BASIC ファイルシステムを提供するライブラリを実装するということです
- また、今回のシステムはドメイン駆動によるDDDアーキテクチャで実装してください、今回の実装例では、大きくわけて2つのメインドメインが登場する事が考えられます
- 1つ目はディスクイメージフォーマットのドメインであり、ディスクイメージの読み込み、セクタの読み書き、クラスタの管理などを行うことが主な責務となります
- 2つ目はファイルシステムのドメインであり、ファイルシステムの構造を表す概念（ディレクトリ、ファイル、クラスタ、FAT、ブートセクタなど）を定義し、これらの概念を用いてファイルシステムを構築する責務となります
- メインドメインの下には、各種サブドメインが登場する可能性がありますが、インフラストラクチャ層でインターフェイスを実装したものでも構いません
  - たとえば、DiskImage メインドメインの下にサブドメイン D88 を登場させても構いませんが、今回は、DiskImage の下に Domain/Interface/IDiskImage.cs インターフェイスを定義し、DiskImage の下に Infrastructure/D88DiskImage.cs を実装する方がスマートと思われます
  - また、FileSystem も同様に、Domain/Interface/IFileSystem.cs インターフェイスを定義し、Infrastructure/HuBasicFileSystem.cs を実装する方がスマートと思われます
- 最初の設計フェイズでは１つのディスクイメージ、１つのファイルシステムしかありませんが、将来的にそれぞれ複数のディスクイメージ、ファイルシステムをサポートする可能性がある事を考慮し、適切なフォルダ構造を採用してください(正当な理由がなければ上記で推奨した方法を採用してください)
- ライブラリ実装が目的ですが、CLI で動作する、一通りの機能を実行可能なプロジェクトも追加してください
  - D88 イメージの新規作成 (2D / 2DD / 2HD フォーマットを選択可能とする)
  - D88 イメージ内の Hu-BASIC ファイルシステムの論理フォーマットの実行 (2D / 2DD / 2HD フォーマットを自動認識し、適宜対応する Hu-BASIC ファイルシステムの論理フォーマットを実行する)
  - D88 イメージ内の Hu-BASIC ファイルシステムへのファイルの入出力
    - ホストOS のテキストファイルを Hu-BASIC ファイルシステムのファイルに書き込む
    - Hu-BASIC ファイルシステムのファイルをホストOS のテキストファイルに読み込む
    - ホストOS のバイナリファイルを Hu-BASIC ファイルシステムのファイルに書き込む
    - Hu-BASIC ファイルシステムのファイルをホストOS のバイナリファイルに読み込む
    - ホストOS のバイナリファイルを Hu-BASIC ファイルシステムのブートセクタに書き込む
    - Hu-BASIC ファイルシステムのブートセクタをホストOS のバイナリファイルに読み込む
    - Hu-BASIC ファイルシステムのファイルを削除する
    - Hu-BASIC ファイルシステムのファイルを一覧表示する
    - Hu-BASIC ファイルシステムのファイルのプロテクト属性を設定する

## 注意点

- Hu-BASIC の ASCII形式(テキストファイル)は、文字コード変換用のサンプルコードを用意しました、Legacy89DiskKit/SampleCode/X1Converter.cs を参照してください。また、漢字や各種マルチバイトは今回は一切使用できないものとし（本来はできるけど割とめんどうそうなので）、ただし、ひらがなとカタカナについてはサンプルの変換プログラム内で対応してると思いますので、それを参考にしてください

